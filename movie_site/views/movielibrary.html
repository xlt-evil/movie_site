<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<style type="text/css">
		.italic {
			font-style:oblique;
		}
		.padding20{
			padding-left: 40px; 
		}
		.div_1{
			margin-top:10px;
			border: 1px solid #999;
			width: 14%;
			border-radius: 15px;
			display: inline-block;
			background-color:transparent;
		}
		.select_1{
			border:none;
			color: #999;
			margin: 5px;
			outline: none;
			width: 20%;
			border-right: 1px solid #999;
			background-color: rgba(0,0,0,0);
		}
		.input_1{
			border:none;
			color: #999;
			outline: none;
			background-color: rgba(0,0,0,0);
		}

		.paddingright20{
			padding-right: 10%;
		}

		.center{
			margin: 0 auto;
			text-align: center;
		}
		.gray{
			margin: 10px;
			color: gray;
		}
		.movecenter{
			position: absolute;
			top: 10%;
		}
		.blue{
			outline: none;
		}
		.goodview a{
			color: #999;
			text-decoration: none;
			padding-left: 10%;
			padding-bottom: 5%;
		}
		.friend{
			text-decoration: none;
			font-size: 15px;
		}
		.movedown{
			margin-top: 10px;
		}
		.br1{
			border-right: 1px solid #eee;
		}
		.copy{
			background-color: #353f4b;
			color: white
		}
		.copy a {
			text-decoration: none;
		}




		.bk{
			background-color: rgba(12, 11, 11, 0.53);
			border:1px solid black;
			color: white;
			box-shadow: 10px 10px 10px black;
		}
		.nob{
			border: 0px;
		}
	</style>
	<style type="text/css">
		.pointer{
			cursor: pointer;
		}
		.tb:hover{
			text-decoration: none;
		}

		@media screen and (max-width: 770px) {
			#T{
				display: none;
			}
		}
		@media screen and (max-width: 920px) {
			.dis{
				padding-left: 0px;
			}
		}
	</style>
</head>
<body style="background-color: #f4f5f7">
	 <div class="container"> 
		<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
			<!-- 100%宽度的响应式布局 -->
			<div class="container-fluid">
				<!-- 商标 -->
				<a href="/" class="navbar-brand italic" style="margin-left:200px;">Movie's Entral</a>
				<div class="collapse navbar-collapse">
					<ul class="nav navbar-nav " >
						<li class="padding20" ><a href="/">首页</a></li>
						<li class="padding20 active"><a href="/tomovielirbary">电影库</a></li>
						<li class="padding20"><a href="/filmreview">影评</a></li>
						<!--  style="margin-right: 500px;" -->
						<li class="padding20"><a href="/news">资讯</a></li>
					</ul>
					<ul class="nav navbar-nav navbar-right paddingright20" id="mytabs">
						{{if .user}}
                            <li class="padding20"><a href="/user/toperson" >{{.user.Name}}个人中心</a></li>
                            <li class="padding20"><a href="#" id = "loginout" >登出</a></li>
						{{else}}
                            <li class="padding20"><a href="" data-toggle="modal" data-target="#myModal">登录</a></li>
                            <li class="padding20"><a href="/account/toregister">注册</a></li>
						{{end}}
					</ul>

					<!-- <div class="div_1 ">
						<select class="select_1">
							<option>全部</option>
							<option>2</option>
							<option>3</option>
						</select>
						<input type="text" name="" class="input_1">
						<span class="glyphicon glyphicon-search"></span>
					</div>  -->
				</div>
			</div>
		</nav>
		</div>
	<br>
	<br>
	<br>
	<div class="container">
		<h3>ME's libaray</h3>
		<div class="row ">
			<!-- 屏幕小于770 隐藏 -->
			<div class="col-sm-3 pull-right " id="T">
				<div class="list-group goodview ">
					<a href="" class="list-group-item  progress-bar progress-bar-striped active" role="progressbar" aria-valuemin="" aria-valuemax="1" style="width: 100%;background-color:#343434;" >本周强推</a>
					{{range $index,$r := .hotmovie.Object}}
						{{if eq $index 0}}
							<a href="/movieintrdouce?movieId={{$r.Id}}" class="list-group-item" style="padding-top: 20%;">{{$r.MovieName}} <span class="badge">{{$r.Score}}</span></a>
						{{else}}
							<a href="/movieintrdouce?movieId={{$r.Id}}" class="list-group-item">{{$r.MovieName}} <span class="badge">{{$r.Score}}</span></a>
						{{end}}
					{{end}}
				</div>
			</div>
			<div class="col-sm-9 clearfix menus">
				<hr>
				<ul class="nav nav-pills clearfix" id="area">
					<li role="presentation" class="active" ><a href="" value="0">全部地区</a></li>
					{{if .resp.Status}}
							{{range $index,$menu := .resp.Object}}
								<li role="presentation" class=""><a href="" value="{{$menu.Id}}">{{$menu.Name}}</a></li>
							{{end}}
					{{end}}
				</ul>
				<hr>
				<ul class="nav nav-pills" id="type">
					<li role="presentation" class="active" ><a href="" value="0">全部类型</a></li>
					{{if .resp1.Status}}
							{{range $index,$menu := .resp1.Object}}
								<li role="presentation" class=""><a href="" value="{{$menu.Id}}">{{$menu.Name}}</a></li>
							{{end}}
					{{end}}
				</ul>
				<hr>
				<ul class="nav nav-pills" id="year">
					<li role="presentation" class="active"><a href="">全部年代</a></li>
					<li role="presentation" class=""><a href="">2018</a></li>
					<li role="presentation" class=""><a href="">2017</a></li>
					<li role="presentation" class=""><a href="">2016</a></li>
					<li role="presentation" class=""><a href="">2015</a></li>
					<li role="presentation" class=""><a href="">2014</a></li>
					<li role="presentation"><a href="">2013</a></li>
					<li role="presentation"><a href="">2012</a></li>
					<li role="presentation"><a href="">2011</a></li>
					<li role="presentation"><a href="">2010</a></li>
					<li role="presentation"><a href="">2009</a></li>
					<li role="presentation"><a href="">2008</a></li>
					<li role="presentation"><a href="">2007以前</a></li>
				</ul>
				<hr>
				<div class="col-sm-5 ">
					<div class="btn-group btn-group-justified sort" style="border: 1px solid #258dcd;border-radius: 5px;">
						<div class="btn-group">
							<button type="button" class="btn btn-info active nob" value="1">热度排序</button>
						</div>
						<div class="btn-group">
							<button type="button" class="btn btn-info nob " value="2">收藏排序</button>
						</div>
						<div class="btn-group">
							<button type="button" class="btn btn-info nob" value="3">评价排序</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<br>
		<div class="row clearfix">
			<div class="col-sm-3 pull-right clearfix " id="T">
				<div class="list-group goodview ">
					<a href="" class="list-group-item  progress-bar progress-bar-striped active" role="progressbar" aria-valuemin="" aria-valuemax="1" style="width: 100%;background-color:#343434;" >随机推荐</a>
					{{range $index,$r := .randmovie.Object}}
						{{if eq $index 0}}
							<a href="/movieintrdouce?movieId={{$r.Id}}" class="list-group-item" style="padding-top: 20%;">{{$r.MovieName}} <span class="badge">{{$r.Score}}</span></a>
						{{else}}
							<a href="/movieintrdouce?movieId={{$r.Id}}" class="list-group-item">{{$r.MovieName}} <span class="badge">{{$r.Score}}</span></a>
						{{end}}
					{{end}}
				</div>
			</div>
			<div class="col-sm-9 movielist">
			{{range $index,$movie := .resp2.Object}}
				<div class="col-sm-4 ">
		       		<a class="thumbnail pointer tb" value="{{$movie.Id}}" style="height: 315px;">
        				<img src="{{$movie.MovieImg}}">
        				<div class="caption">
        					<h4 class="text-center">{{$movie.MovieName}}&nbsp;<span class="label label-warning ">{{$movie.Score}}</span></h4>
        					<p class="text-center"></p>
        					<p class="text-center">{{$movie.Introuduce}}</p>
        				</div>
        			</a>
				</div>
			{{end}}
			</div> 
		</div>

		<!-- row 默认为当前最大值 所以要用一个div 进行区分分页 -->
		<div class="row">
			<div class="col-sm-9">
				<nav aria-label="Page navigation ">
  		  			<ul class="pager col-sm-offset-1">
   			 			<li id="prev" class="disabled"><a href="#" >Previous</a></li>
   			 			<li id="page" value="1" style="color: #efbcbc">&nbsp;1&nbsp;</li>
    					<li id="next"><a href="#">Next</a></li>
  					</ul>
				</nav>
			</div>
		</div>
	</div>
	<!-- 页尾 -->
	<div style="width: 100%;margin-top: 2%;" >
	    <div class="jumbotron copy" style="margin: 0">
	    	<div class="container">
  			<p class="text-center">本站所有信息均由互联网爬虫自动搜索得来，相关链接已注明来源，版权归原创者所有。</p>
  			<p class="text-center">如果无意中侵犯了您的权益，请通知我（hjlmzx5@163.com)，我们会及时做相应处理，谢谢合作。</p>
  			</div>
			<p class="text-center"><a href=""><small>&copy;Movie's Entral.com Author:Hxy</small></a></p>
		</div>
	</div>
<!-- 可以复用的弹框 -->
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLable" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content col-sm-8 col-sm-offset-2 ">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="close"><span aria-hidden="true">&times;</span></button>
					<h3 class="center ">为爱电影的人</h3>
					<h5 class="center gray">For People Who love's Movie</small>
				</div>
				<div class="modal-body">
					<form class="form-horizontal" role="form">
						<div class="form-group">
							<!-- <label class="control-label col-sm-2">用户名</label>  -->
							<div class="col-sm-10">
								<input type="text" name="" placeholder="请输入用户名" class="form-control username">
								<span style="color:#ec7474"></span>
							</div>
						</div>
						<div class="form-group">
							<!-- <label class="control-label col-sm-2">密码</label>  -->
							<div class="col-sm-10">
								<input type="password" name="" placeholder="请输入密码" class="form-control password">
								<span style="color:#ec7474"></span>
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-10 ">
								<div class="checkbox">
									<label>
										<input type="checkbox" name="">记住密码
									</label>
								</div>
							</div>
						</div>
						 <div class="form-group">
   							 <div class="col-sm-12">
      							<button type="button" class="btn btn-primary btn-lg col-sm-10" id="login">登录</button>
    						</div>
  						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button class="btn btn-default col-sm-3" style="margin-right:30%; " type="button" data-dismiss="modal">忘记密码</button>
					<button class="btn btn-primary col-sm-3" type="button" id="register">注册账号</button>
				</div>
			</div>
		</div>
	</div>

	<!-- 复用 -->
	<script type="text/javascript" src="../static/js/jquery-3.0.0.min.js"></script>
	<script type="text/javascript" src="../static/js/bootstrap.min.js"></script>
	<script type="text/javascript">
			$(".username").blur(function(){
				var $name = $(this)
				if($name.val() == ""){
					$name.next().text("账户不能为空")
					return
				}else{
					$name.next().text("")
				}
				if($name.val().length < 6 || $name.val().length > 11){
					$name.next().text("请按要求的长度范围输入！")
				}else{
					$name.next().text("")
				}

			});

			// 判断密码是否为空
			$(".password").blur(function(){
				var $pwd = $(this)
				if($pwd.val() == ""){
					$pwd.next().text("密码不能为空")
					return
				}else{
					$pwd.next().text("")
				}
				if($pwd.val().length < 6 || $pwd.val().length > 11){
					$pwd.next().text("请按要求的长度范围输入！")
				}else{
					$pwd.next().text("")
				}
			});

			$("#login").click(function(){
				$("#login").next().text('')
				alert("秀秀秀秀")
				var vals = $(this).parent().parent().parent().find("input")
				var vales =  {}
				for(var i = 0;i<2;i++){
					vales[i] = $(vals[i]).val()
					console.log(vales[i])
					if(vales[i] == "" ){
						alert("还有选项没填！")
						return
					}
				}
				if (vales[1].length <6 || vales[1].length >11 || vales[0].length <6 || vales[0].length >11){
					alert("按要求输入谢谢！")
					return
				}
				$.ajax({
					url:'/account/login',
					type:'get',
					dataType:'json',
					data:{
						"Uid":vales[0],
						"Password":vales[1]
					},
					success:function(result){
						if (result.Status) {
							alert(result.Msg)
							for(var i = 0;i<vals.length;i++){
								$(vals[i]).val("")
							}
							// 修改了不要跳到首页
							window.location.href = "/tomovielirbary"
							return
						}
						$("#login").next().text(result.Msg)
					},
					error:function(){
						alert("服务器出现问题请稍后重试")
					}
				})
			});
		// ==================================

		$("#register").click(function(){
			window.location.href = "/account/toregister"
		});

		$("#loginout").click(function(){
			var ok = confirm("确定要退出登录吗？")
			if (ok) {
				window.location.href = "/account/loginout"
			}
		});

		// ===================================电影库页面专用js

		$(".menus ul a").click(function(e){
			e.preventDefault()
			$(this).tab("show")
			var value = $(".menus ul .active a")
			var year = $(value[2]).text()
			var sort = $(".sort .active").attr("value")
			console.log(sort)
			var area = $(value[0]).attr("value")
			console.log(area)
			var type = $(value[1]).attr("value")
			console.log(area)
			$.ajax({
				url: '/movie/movielibrary',
				type: 'get',
				dataType: 'json',
				data: {"area":area,"type":type,"year":year,"sort":sort,"page":1},
				success:function(result){
					$(".movielist").empty()
					if (result.Status){
						for(var i = 0;i<result.Object.length;i++){
							var text = `<div class="col-sm-4 ">`+
		       								"<a class='thumbnail pointer tb' value="+result.Object[i].Id+" style='height: 315px;'>"+
        									"<img src='"+result.Object[i].MovieImg+"'>"+
											"<div class='caption'>"+
        										"<h4 class='text-center'>"+result.Object[i].MovieName+"&nbsp;<span class='label label-warning ''>"+result.Object[i].Score+"</span></h4>"+
        										"<p class='text-center'></p>"+
        										"<p class='text-center'>"+result.Object[i].Introuduce+"</p>"+
        									"</div>"+
        									"</a>"+
										"</div>"
							$(".movielist").append(text)
						}
						if (result.Pref){
							$("#prev").removeClass('disabled')
						}else{
							$("#prev").addClass('disabled')
						}
						if(result.Next){
							$("#next").removeClass('disabled')
						}else{
							$("#next").addClass('disabled')
						}
						$("#page").attr("value",result.Page)
						$("#page").text(1)
					}else{
						var text = `<div class="alert alert-danger" role="alert">
										<p class="center">暂时没有符合您要求的电影，请放宽筛选条件</p>
  										<p class="center"><span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
  											<span class="sr-only">Error:</span>
				 						    	There is no sign of the conditions you require
				 						</p>
									</div>`
						$(".movielist").append(text)
						$("#prev").addClass('disabled')
						$("#next").addClass('disabled')
					}
				}

			})
			
		})
		$(".sort button").click(function(e){
			$(".sort button").removeClass('active')
			$(this).addClass('active')
		})

		$("#prev a").click(function(e){
			if($("#prev").hasClass('disabled')){
				alert("当前已经是首页了！")
				return
			}
			e.preventDefault()
			var value = $(".menus ul .active a")
			var year = $(value[2]).text()
			var sort = $(".sort .active").attr("value")
			console.log(sort)
			var area = $(value[0]).attr("value")
			console.log(area)
			var type = $(value[1]).attr("value")
			console.log(area)
			var page = parseInt($("#page").attr("value"))-1
			$.ajax({
				url: '/movie/movielibrary',
				type: 'get',
				dataType: 'json',
				data: {"area":area,"type":type,"year":year,"sort":sort,"page":page},
				success:function(result){
					$(".movielist").empty()
					if (result.Status){
						for(var i = 0;i<result.Object.length;i++){
							var text = `<div class="col-sm-4 ">`+
		       								"<a class='thumbnail pointer tb' value="+result.Object[i].Id+" style='height: 315px;'>"+
	    									"<img src='"+result.Object[i].MovieImg+"'>"+
											"<div class='caption'>"+
	    										"<h4 class='text-center'>"+result.Object[i].MovieName+"&nbsp;<span class='label label-warning ''>"+result.Object[i].Score+"</span></h4>"+
	    										"<p class='text-center'></p>"+
	    										"<p class='text-center'>"+result.Object[i].Introuduce+"</p>"+
	    									"</div>"+
	    									"</a>"+
										"</div>"
							$(".movielist").append(text)
						}
						if (result.Pref){
							$("#prev").removeClass('disabled')
						}else{
							console.log(result.Pref)
							$("#prev").addClass('disabled')
						}
						if(result.Next){
							$("#next").removeClass('disabled')
						}else{
							$("#next").addClass('disabled')
						}
						$("#page").attr("value",result.Page)
						$("#page").html("&nbsp;"+result.Page+"&nbsp;")
					}
				}
			})
		})

		$("#next a").click(function(e){
			if($("#next").hasClass('disabled')){
				alert("当前已经是尾页了！")
				return
			}
			e.preventDefault()
			var value = $(".menus ul .active a")
			var year = $(value[2]).text()
			var sort = $(".sort .active").attr("value")
			var area = $(value[0]).attr("value")
			var type = $(value[1]).attr("value")
			var page = parseInt($("#page").attr("value"))+1
			$.ajax({
				url: '/movie/movielibrary',
				type: 'get',
				dataType: 'json',
				data: {"area":area,"type":type,"year":year,"sort":sort,"page":page},
				success:function(result){
					$(".movielist").empty()
					if (result.Status){
						for(var i = 0;i<result.Object.length;i++){
							var text = `<div class="col-sm-4 ">`+
		       								"<a class='thumbnail pointer tb' value="+result.Object[i].Id+" style='height: 315px;'>"+
	    									"<img src='"+result.Object[i].MovieImg+"'>"+
											"<div class='caption'>"+
	    										"<h4 class='text-center'>"+result.Object[i].MovieName+"&nbsp;<span class='label label-warning ''>"+result.Object[i].Score+"</span></h4>"+
	    										"<p class='text-center'></p>"+
	    										"<p class='text-center'>"+result.Object[i].Introuduce+"</p>"+
	    									"</div>"+
	    									"</a>"+
										"</div>"
							$(".movielist").append(text)
						}
						if (result.Pref){
							$("#prev").removeClass('disabled')
						}else{
							console.log(result.Pref)
							$("#prev").addClass('disabled')
						}
						if(result.Next){
							$("#next").removeClass('disabled')
						}else{
							$("#next").addClass('disabled')
						}
						$("#page").attr("value",result.Page)
						$("#page").text(" "+result.Page+" ")
					}
				}
			})
		})

		// 排序
		$(".sort .btn").click(function(e){

			if ($(".alert").length>0){
				alert("当前页面没有电影！无法排序")
				return
			}
			e.preventDefault()
			var value = $(".menus ul .active a")
			var year = $(value[2]).text()
			var sort = $(".sort .active").attr("value")
			var area = $(value[0]).attr("value")
			var type = $(value[1]).attr("value")
			var page = parseInt($("#page").attr("value"))
			$.ajax({
				url: '/movie/movielibrary',
				type: 'get',
				dataType: 'json',
				data: {"area":area,"type":type,"year":year,"sort":sort,"page":page},
				success:function(result){
					$(".movielist").empty()
					if (result.Status){
						for(var i = 0;i<result.Object.length;i++){
							var text = `<div class="col-sm-4 ">`+
		       								"<a class='thumbnail pointer tb' value="+result.Object[i].Id+" style='height: 315px;'>"+
	    									"<img src='"+result.Object[i].MovieImg+"'>"+
											"<div class='caption'>"+
	    										"<h4 class='text-center'>"+result.Object[i].MovieName+"&nbsp;<span class='label label-warning ''>"+result.Object[i].Score+"</span></h4>"+
	    										"<p class='text-center'></p>"+
	    										"<p class='text-center'>"+result.Object[i].Introuduce+"</p>"+
	    									"</div>"+
	    									"</a>"+
										"</div>"
							$(".movielist").append(text)
						}
					}
				}
			})
		})

		// 跳转到电影具体介绍
		$(document).on('click', '.movielist .tb', function(event) {
			console.log(123+$(this))
			var movieId = $(this).attr("value")
 			window.location.href = "/movieintrdouce?movieId="+movieId
		});
	</script>
</body>
</html>